"use strict";var __awaiter=this&&this.__awaiter||function(t,o,s,c){return new(s=s||Promise)(function(a,e){function r(t){try{n(c.next(t))}catch(t){e(t)}}function i(t){try{n(c.throw(t))}catch(t){e(t)}}function n(t){var e;t.done?a(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(r,i)}n((c=c.apply(t,o||[])).next())})},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.segmark=void 0;const gray_matter_1=__importDefault(require("gray-matter")),getApiData=e=>__awaiter(void 0,void 0,void 0,function*(){try{const t=yield fetch(e);return yield t.json()}catch(t){return""+e}}),segmark=(s,c=!1)=>__awaiter(void 0,void 0,void 0,function*(){let t=s,e={data:{}};c?t=yield getApiData(s):e=(0,gray_matter_1.default)(s);var a=new RegExp("(±.*?)[\\s\\S]*?\\1","gi"),a=t.match(a)||[];const r=Object.assign({},Object.keys(e.data).length?{vars:e.data}:{});let i;if(a.length)for(i of a){var n=i.match(/±(.*?)\n([^;]*)±/);let[,e,a]=null!=n?n:[];if(e&&a){a=a.trim();var o,n=-1<e.indexOf("api_");let t;n&&(e=e.replace("api_",""),o=yield getApiData(a),t=yield segmark(o));try{n||(t=JSON.parse(a)),r[e]=t}catch(t){r[e]=a}}}return 0!==a.length?r:s.trim()});exports.segmark=segmark,exports.default={segmark:segmark};