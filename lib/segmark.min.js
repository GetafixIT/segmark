"use strict";var __awaiter=this&&this.__awaiter||function(t,o,c,s){return new(c=c||Promise)(function(a,e){function r(t){try{n(s.next(t))}catch(t){e(t)}}function i(t){try{n(s.throw(t))}catch(t){e(t)}}function n(t){var e;t.done?a(t.value):((e=t.value)instanceof c?e:new c(function(t){t(e)})).then(r,i)}n((s=s.apply(t,o||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.segmark=void 0;const matter=require("gray-matter"),getApiData=e=>__awaiter(void 0,void 0,void 0,function*(){try{const t=yield fetch(e);return yield t.json()}catch(t){return""+e}}),segmark=(c,s=!1)=>__awaiter(void 0,void 0,void 0,function*(){let t=c,e={data:{}};s?t=yield getApiData(c):e=matter(c);var a=new RegExp("(±.*?)[\\s\\S]*?\\1","gi"),a=t.match(a)||[];const r=Object.assign({},Object.keys(e.data).length?{vars:e.data}:{});let i;if(a.length)for(i of a){var n=i.match(/±(.*?)\n([^;]*)±/);let[,e,a]=null!=n?n:[];if(e&&a){a=a.trim();var o,n=-1<e.indexOf("api_");let t;n&&(e=e.replace("api_",""),o=yield getApiData(a),t=yield segmark(o));try{n||(t=JSON.parse(a)),r[e]=t}catch(t){r[e]=a}}}return 0!==a.length?r:{markdown:c.trim()}});exports.segmark=segmark,exports.default={segmark:segmark};